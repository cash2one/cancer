<!DOCTYPE HTML>
{% extends "base.html" %}
{% load staticfiles %}
{%block script%}
<script src="{% static "js/jquery.dataTables.js" %}"></script>
<link rel="stylesheet" href="{% static "css/jquery.dataTables.css" %}" />

<link rel="stylesheet" href="{% static "timeline/css/timeline-reset.css"%}"/> <!-- CSS reset -->
<link rel="stylesheet" href="{% static "timeline/css/timeline-style.css"%}"/> <!-- Resource style -->

<script src="{% static "timeline/js/timeline-modernizr.js" %}"></script> <!-- Modernizr -->
<script src="{% static "timeline/js/timeline-main.js" %}"></script> <!-- Resource jQuery -->


<style>
  div.dataTables_filter {
      text-align: left;
  }
  .col-sm-6 {
      width: 20%;
  }
  .filterMatches { background-color: #FFFF00; }

  </style>


<script>

$(document).ready(function() {

    //hide empty columns
    $('#recent tr th').each(function(i) {
     //select all tds in this column
     var tds = $(this).parents('table')
              .find('tr td:nth-child(' + (i + 1) + ')');
        //check if all the cells in this column are empty
        if(tds.length == tds.filter(':empty').length) { 
            //hide header
            $(this).hide();
            //hide cells
            tds.hide();
        } 
    }); 


     var table = $('#recent').dataTable( {
        //highlight search text, CHECK
        "fnRowCallback": function( nRow, aData, iDisplayIndex, iDisplayIndexFull) {
            var settings = this.fnSettings();
            var str = settings.oPreviousSearch.sSearch;
            var regex = new RegExp( str, 'i');
            $('td', nRow).each( function(i) {
                this.innerHTML = aData[i].replace( regex, function(matched) { return "<span class='filterMatches'>"+matched+"</span>";});
            });
            return nRow;
        },

        "language": {
            "url": "//cdn.datatables.net/plug-ins/1.10.8/i18n/Chinese.json"
        },
        "scrollX": true,
        "scrollY": 800,
        "pageLength": 10,
        "bAutoWidth": true,
        'searchHighlight': true,
        "order": [[ 2, "desc" ]],

    } );//table
} );
</script>




{%endblock%}
{% block content %}
<ul class="breadcrumb">
   <li><a href="/">主页</a></li>
   <li><a href="/dashboard/">控制台</a></li>
   <li class="active">病人详细信息</li>
</ul>


<ul class="nav nav-tabs">
  <li class="active"><a href="#home" data-toggle="tab" >病人基本信息</a></li>
  <li class=""><a href="#cancer" data-toggle="tab" >肿瘤基本信息</a></li>
  <li ><a href="#symptom" data-toggle="tab" >症状与体征</a></li>
  <li ><a href="#treatment" data-toggle="tab" >治疗情况</a></li>
  <li ><a href="#test" data-toggle="tab" >辅助检查</a></li>
  <li ><a href="#followup" data-toggle="tab" >随访情况</a></li>
  <li ><a href="#questionnaire" data-toggle="tab" >问卷评分</a></li>
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
      其他操作 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
      <li><a href="#" target="_blank" data-toggle="tab">下载病人信息</a></li>
      <li class="divider"></li>
      <li><a href="#" target="_blank" data-toggle="tab">修改病人信息</a></li>
      <li class="divider"></li>
      <li><a href="#" target="_blank" data-toggle="tab">添加日志</a></li>
    </ul>
  </li>

</li>
</ul>



<div id="myTabContent" class="tab-content">

  <div class="tab-pane fade active in" id="home">

   <div class="panel panel-success" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
    <div class="panel-heading" >
      <h3>病人基本信息</h3>
    </div>
  </div>




    <div class="box-container" style='width:80%'>
    <div class="content">
      <header style=" margin-top: 0px; margin-bottom: 50px; padding-bottom: 0px; height: 100px; padding-top: 0px; ">
      <div style="text-align: center;">
      <h1 style="text-align: center; vertical-align: middle;display: inline-block;"> 病人时间轴</h1>      
      </div>
      </header>
    <section id="cd-timeline" class="cd-container">
      {% for cancer in cancers %}
      <div class="cd-timeline-block">
        <div class="cd-timeline-img cd-movie">
        </div> <!-- cd-timeline-img -->
        <div class="cd-timeline-content">
          <p>肿瘤基本信息: {{cancer.project_name}}</p>
          <h2>诊断: {{cancer.diagnosis}}</h2>
          <a href="{{experiment.get_absolute_url}}" class="cd-read-more">详细信息</a>
          <span class="cd-date">TODO</span>
        </div> <!-- cd-timeline-content -->
      </div> <!-- cd-timeline-block -->
      {% endfor %}
    </section> <!-- cd-timeline -->
    </div>
    </div>

<!--
<table class="table table-bordered table-striped" id="recent" class="display" cellspacing="0" width="90%">
  <thead>
      <tr>
          <th>数据库编号</th>
          <th>姓名</th>
          <th>病历号</th>
          <th>性别</th>
          <th>出生年月</th>
          <th>身份证号</th>
          <th>地区</th>
          <th>随访电话</th>
          <th>去世日期</th>
          <th>关系</th>
          <th>电话</th>
          <th>Email</th>
          <th>微信</th>
          <th>在随访中</th>
      </tr>
  </thead>

  <tbody>
  <tr>
      <td><a href="{{patient.get_absolute_url}}">{{patient.DB_ID}}</a></td>
      <td>{{patient.name}}</td>
      <td>{{patient.EMR_id}}</td>
      <td>{{patient.sex}}</td>
      <td>{{patient.DOB}}</td>
      <td>{{patient.social_id}}</td>
      <td>{{patient.location}}</td>
      <td>{{patient.phone}}</td>
      <td>{{patient.DOD}}</td>
      <td>{{patient.get_relative_display}}</td>
      <td>{{patient.relative_phone}}</td>
      <td>{{patient.relative_email}}</td>
      <td>{{patient.relative_wechat}}</td>
      <td>{{patient.get_relative_in_contact_display}}</td>

  </tr>
  </tbody>
</table>
-->

 </div> <!--tab 1-->
 

 <div class="tab-pane fade" id="cancer">
<!-- Post Section -->

	<div class="panel panel-info" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
	  <div class="panel-heading" >
	    <h3>肿瘤基本信息</h3>
	  </div>
	</div>


<table class="table table-bordered table-striped" id="recent" class="display" cellspacing="0" width="90%">
  <thead>
    <tr>
      <th>数据库编号</th>
      <th>姓名</th>
      <th>病历号</th>
      <th>入院日期</th>
      <th>出院日期</th>
      <th>住院科室</th>
      <th>术前诊断</th>
      <th>最终诊断</th>
      <th>诊断依据</th>
      <th>肿瘤性质</th>
      <th>肿瘤分类</th>
      <th>肿瘤复发</th>
      <th>脊柱病灶数目</th>
      <th>肿瘤部位</th>
      <th>脊柱外骨累及</th>
      <th>原发灶外重要脏器累及</th>
      <th>重要脏器累及可控制</th>
      <th>备注</th>
    </tr>
  </thead>

  <tbody>
  {% for cancer in cancers %}
  <tr>
      <td><a href="{{cancer.get_absolute_url}}">{{cancer.DB_ID}}</a></td>
      <td>{{cancer.name}}</td>
      <td>{{cancer.EMR_id}}</td>
      <td>{{cancer.admission_date}}</td>
      <td>{{cancer.discharge_date}}</td>
      <td>{{cancer.get_department_display}}</td>
      <td>{{cancer.pre_diagnosis}}</td>
      <td>{{cancer.diagnosis}}</td>
      <td>{{cancer.get_diagnosis_basis_display}}</td>
      <td>{{cancer.get_cancer_property_display}}</td>
      <td>{{cancer.get_cancer_type_display}}</td>
      <td>{{cancer.get_recurrence_display}}</td>
      <td>{{cancer.get_focus_display}}</td>
      <td>{{cancer.get_location_display}}</td>
      <td>{{cancer.get_infection_spinal_display}}</td>
      <td>{{cancer.get_infection_organ_display}}</td>
      <td>{{cancer.get_infection_organ_controllable_display}}</td>
      <td>{{cancer.comment}}</td>
  </tr>
  {% endfor %}
  </tbody>
</table>


 </div>  <!--tab 2-->


  <div class="tab-pane fade" id="symptom">
    <div class="panel panel-info" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
      <div class="panel-heading" >
        <h3>症状与体征</h3>
      </div>
    </div>
        

  </div> <!--tab 3-->

  <div class="tab-pane fade" id="treatment">
    <div class="panel panel-info" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
      <div class="panel-heading" >
        <h3>治疗情况</h3>
      </div>
    </div>
        

  </div> <!--tab 4-->

  <div class="tab-pane fade" id="test">
    <div class="panel panel-info" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
      <div class="panel-heading" >
        <h3>辅助检查</h3>
      </div>
    </div>
        

  </div> <!--tab 5-->

  <div class="tab-pane fade" id="followup">
    <div class="panel panel-info" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
      <div class="panel-heading" >
        <h3>随访情况</h3>
      </div>
    </div>
        

  </div> <!--tab 6-->

  <div class="tab-pane fade" id="questionnaire">
    <div class="panel panel-info" style="width:95%;margin-top:20px;margin-left:auto;margin-right:auto;">
      <div class="panel-heading" >
        <h3>问卷评分</h3>
      </div>
    </div>
        

  </div> <!--tab 7-->

</div>

{% endblock %}

